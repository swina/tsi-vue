(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27225cb7","chunk-34c6eaf8","chunk-2d0dde02","chunk-2d0d83b8"],{"79cc":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.questions?s("div",{staticClass:"relative w-full overflow-y-auto m-4 flex flex-col"},[t._l(Object.keys(t.questions),(function(e,a){return[a>=t.start&&a<=t.start+t.limit?s("div",{staticClass:"flex flex-row mb-1 items-center"},[s("div",{staticClass:"w-10 text-right text-lg bg-gray-200 pr-2 mr-2 p-1"},[t._v(t._s(e))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.questions[e].domanda,expression:"questions[question].domanda"}],staticClass:"bg-white w-9/12 p-1r",staticStyle:{"font-family":"'Arial'"},attrs:{type:"text"},domProps:{value:t.questions[e].domanda},on:{input:function(s){s.target.composing||t.$set(t.questions[e],"domanda",s.target.value)}}}),t._m(0,!0)]):t._e()]})),s("div",{staticClass:"w-full flex flex-row items-center p-2 justify-center"},[s("button",{staticClass:"rounded-bl rounded-tl",on:{click:function(e){t.start>0&&(t.start=t.start-t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_left")])]),s("button",{staticClass:"rounded-tr rounded-br",on:{click:function(e){t.start+t.limit<t.total&&(t.start=t.start+t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_right")])])]),s("div",{staticClass:"w-full flex flex-row items-center p-2 justify-center"},[s("button",{staticClass:"rounded success",on:{click:t.save}},[t._v("Salva Quesiti")])])],2):t._e()},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-2/12 p-1 text-gray-500"},[s("i",{staticClass:"material-icons"},[t._v("delete")])])}],n=(s("7db0"),s("b64b"),{data:function(){return{questions:null,currentIndex:-1,start:0,limit:10,total:0,edit:!1}},computed:{},methods:{save:function(){}},mounted:function(){var t=this;this.$api.service("questions").find({query:{id:this.$attrs.survey}}).then((function(e){t.$store.dispatch("dataset",{table:"questions",data:e.data[0].questions}),t.questions=e.data[0].questions,t.total=Object.keys(t.questions).length}))}}),o=n,r=s("2877"),l=Object(r["a"])(o,a,i,!1,null,null,null);e["default"]=l.exports},"82f8":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"relative overflow-y-auto m-4 flex flex-col border-t border-l border-r"},[t._l(Object.keys(t.$attrs.domande.questions),(function(e,a){return[a>=t.start&&a<=t.start+t.limit?s("div",{staticClass:"flex flex-row border-b"},[s("div",{staticClass:"w-1/12 text-left mr-4 border-r p-1"},[t._v(t._s(e))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.$attrs.domande.questions[e].domanda,expression:"$attrs.domande.questions[domanda].domanda"}],staticClass:"bg-white w-9/12 p-1 border-r",staticStyle:{"font-family":"'Arial'"},attrs:{type:"text"},domProps:{value:t.$attrs.domande.questions[e].domanda},on:{input:function(s){s.target.composing||t.$set(t.$attrs.domande.questions[e],"domanda",s.target.value)}}}),t._m(0,!0)]):t._e()]})),s("div",{staticClass:"w-full flex flex-row items-center p-2 justify-center"},[s("button",{staticClass:"rounded-bl rounded-tl",on:{click:function(e){t.start>0&&(t.start=t.start-t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_left")])]),s("button",{staticClass:"rounded-tr rounded-br",on:{click:function(e){t.start+t.limit<t.total&&(t.start=t.start+t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_right")])])]),s("transition",{attrs:{name:"fade"}},[t.edit?s("moka-modal",{attrs:{size:"md"},on:{close:function(e){t.edit=!t.edit}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Modifica Domanda")]),s("div",{staticClass:"p-8",attrs:{slot:"content"},slot:"content"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.$attrs.domande.questions[t.currentIndex].domanda,expression:"$attrs.domande.questions[currentIndex].domanda"}],staticClass:"w-full",domProps:{value:t.$attrs.domande.questions[t.currentIndex].domanda},on:{input:function(e){e.target.composing||t.$set(t.$attrs.domande.questions[t.currentIndex],"domanda",e.target.value)}}})])]):t._e()],1)],2)},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-2/12 p-1 text-gray-500"},[s("i",{staticClass:"material-icons"},[t._v("delete")])])}],n=(s("b64b"),{data:function(){return{currentIndex:-1,start:0,limit:10,edit:!1}},computed:{total:function(){return Object.keys(this.$attrs.domande.questions).length}}}),o=n,r=s("2877"),l=Object(r["a"])(o,a,i,!1,null,null,null);e["default"]=l.exports},a0b6:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"grid grid-cols-1 w-11/12 text-sm ml-8 mt-4 border-t border-l border-r"},[t.login?t._e():s("div",{class:"bg-gray-300 p-2 grid grid-cols-"+Object.keys(t.schema.questionario).length},[t._l(Object.keys(t.schema.questionario),(function(e){return["_id"!=e&&t.schema.questionario[e].list?s("div",{staticClass:"font-bold capitalize"},[t._v(t._s(e))]):t._e()]})),s("div",{})],2),t._l(t.questionari,(function(e){return[s("div",{class:"p-2 border-b w-full hover:bg-gray-200 cursor-pointer grid grid-cols-"+Object.keys(t.schema.questionario).length},[t._l(Object.keys(t.schema.questionario),(function(a){return["_id"!=a&&t.schema.questionario[a].list?s("div",[t._v(t._s(t.schema.questionario[a].format(e[a])))]):t._e()]})),s("div",{staticClass:"flex flex-row justify-end col-span-3"},[s("button",{on:{click:function(s){t.record=e,t.edit=!t.edit}}},[t._v("Modifica")]),s("button",{staticClass:"mx-2",on:{click:function(s){t.getDomande(e),t.record=e,t.updateDomande=!t.updateDomande}}},[t._v("Domande")]),s("button",{on:{click:function(s){return t.simulator(e._id)}}},[t._v("Simula")]),t._v(" CODE [a763va] ")])],2)]})),s("transition",{attrs:{name:"fade"}},[t.questionario&&t.domande&&t.updateDomande?s("moka-modal",{attrs:{size:"lg",position:"modal",buttons:"save"},on:{close:function(e){t.updateDomande=!t.updateDomande},click_0:function(e){t.updateDomande=!t.updateDomande},click_1:t.save}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.record.project))]),s("div",{attrs:{slot:"content"},slot:"content"},[s("v-domande",{attrs:{domande:t.domande}})],1)]):t._e()],1),s("transition",{attrs:{name:"fade"}},[t.simulation?s("moka-modal",{attrs:{size:"lg",position:"modal",buttons:"none"},on:{close:function(e){t.simulation=!t.simulation}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Persone")]),s("div",{staticClass:"p-4 relative",attrs:{slot:"content"},slot:"content"},[s("v-person"),s("div",{staticClass:"mt-2 bg-red-200 w-full p-1 h-8",class:t.errore?"opacity-100":"opacity-0"},[t._v(t._s(t.errore))]),s("div",{staticClass:"mt-2 bg-red-200 w-full p-1 h-8",class:t.incompleto?"opacity-100":"opacity-0"},[t._v(t._s(t.incompleto)+" "),s("button",{staticClass:"danger",on:{click:function(e){t.userRisposta={},t.incompleto="",t.simulation=!t.simulation}}},[t._v("Esci")])])],1)]):t._e()],1),s("transition",{attrs:{name:"fade"}},[t.edit?s("moka-modal",{attrs:{size:"full",position:""},on:{close:function(e){t.edit=!t.edit},click_0:function(e){t.edit=!t.edit},click_1:t.save}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.record.project))]),t.edit?s("v-questionario",{attrs:{slot:"content"},slot:"content",model:{value:t.record,callback:function(e){t.record=e},expression:"record"}}):t._e()],1):t._e()],1)],2)},i=[],n=(s("fb6a"),s("b64b"),s("7db0"),s("fda7")),o=s("b9a1"),r=s("82f8"),l=s("d95b"),c={name:"TSIPluginDashboard",components:{VQuestionario:o["default"],VDomande:r["default"],VPerson:l["default"]},data:function(){return{login:!1,user:{email:"",password:""},editor:!1,questionari:null,questionario:null,record:null,domande:null,updateDomande:!1,simulation:!1,simulationEnd:!1,errore:"",incompleto:"",edit:!1,index:0,total:0,seconds:0,userRisposta:{},questionStartedAt:0}},computed:{schema:function(){return n["default"]},elapsed:function(){function t(t,e){return e=e||2,("00"+t).slice(-e)}var e=1e3*this.seconds,s=e%1e3;e=(e-s)/1e3;var a=e%60;e=(e-a)/60;var i=e%60,n=(e-i)/60;return t(n)+":"+t(i)+":"+t(a)}},watch:{simulation:function(t){var e=this;t&&window.setInterval((function(){e.seconds+=1}),1e3)},simulationEnd:function(t){t&&(console.log(Object.keys(this.userRisposta).length),Object.keys(this.userRisposta).length<Object.keys(this.domande.questions).length&&(this.incompleto="Non hai completato il questionario. Vuoi comunque interrompere?"))}},methods:{next:function(){if(this.userRisposta[this.index+1]){this.errore="";var t={risposta:this.userRisposta[this.index+1],elapsed:parseInt(this.seconds)-parseInt(this.questionStartedAt)};this.userRisposta[this.index+1]=t,this.questionStartedAt=this.seconds,this.index=this.index+1}else this.errore="Indicare una scelta"},simulator:function(t){var e=this.$router.resolve({path:"/survey"});window.open(e.href,"tsi","width="+window.screen.availWidth)},getDomande:function(t){var e=this;this.questionario=t,this.$api.service("questions").find({query:{id:t.id}}).then((function(t){e.domande=t.data[0],e.total=Object.keys(e.domande.questions).length}))},save:function(){var t=this;this.$api.service("surveys").patch(this.record._id,this.record).then((function(e){console.log(e),t.edit=!1,t.$message("Questionario salvato")}))},loadData:function(){var t=this;this.$api.service("surveys").find().then((function(e){console.log(e),t.$store.dispatch("dataset",{table:"surveys",data:e.data}),t.questionari=e.data}))},doLogin:function(){var t=this;this.$api.authenticate({email:this.user.email,password:this.user.password,strategy:"local"}).then((function(e){console.log(e),t.login=!1,t.loadData()})).catch((function(e){console.log(e),t.$message("Email o password errati!")}))}},mounted:function(){var t=this;this.$api.authenticate().then((function(e){console.log("authenticated"),t.loadData()})).catch((function(e){t.login=!0}))}},d=c,u=s("2877"),m=Object(u["a"])(d,a,i,!1,null,null,null);e["default"]=m.exports},b9a1:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-2"},[s("button",{class:0===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=0}}},[t._v("Generale")]),s("button",{class:2===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=2}}},[t._v("Risposte")]),s("button",{class:3===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=3}}},[t._v("Domande")]),s("button",{class:1===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=1}}},[t._v("Descrizione")]),t.schema?s("div",{staticClass:"grid grid-cols-2 gap-4 p-8 border rounded"},[t._l(Object.keys(t.schema),(function(e){return[t.schema[e].tab===t.tab&&"boolean"!=t.schema[e].type?s("div",{staticClass:"flex flex-col",class:"text"===t.schema[e].type?"col-span-2":""},[s("label",{staticClass:"font-bold capitalize"},[t._v(t._s(t.schema[e].label))]),t.schema[e].tab===t.tab&&"string"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",attrs:{type:"text"},domProps:{value:t.record[e]},on:{input:[function(s){s.target.composing||t.$set(t.record,e,s.target.value)},function(e){return t.$emit(e.target.value)}]}}):t._e(),t.schema[e].tab===t.tab&&"number"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",attrs:{type:"number",min:"1"},domProps:{value:t.record[e]},on:{input:[function(s){s.target.composing||t.$set(t.record,e,s.target.value)},function(e){return t.$emit(e.target.value)}]}}):t._e(),"excerpt"===t.schema[e].type?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",domProps:{value:t.record[e]},on:{input:function(s){s.target.composing||t.$set(t.record,e,s.target.value)}}}):t._e(),t.schema[e].tab===t.tab&&"text"===t.schema[e].type?s("div",["text"===t.schema[e].type?s("v-editor",{staticClass:"w-full",model:{value:t.$attrs.value.description,callback:function(e){t.$set(t.$attrs.value,"description",e)},expression:"$attrs.value.description"}}):t._e()],1):t._e(),t.schema[e].tab===t.tab&&"array"===t.schema[e].type?s("div",[t._l(t.$attrs.value[e],(function(a,i){return[s("div",{staticClass:"flex flex-row"},[s("input",{staticClass:"w-full",attrs:{type:"text"},domProps:{value:a},on:{input:function(s){return t.updateArray(i,e,s.target.value)}}}),t._v(" "),s("i",{staticClass:"material-icons ml-2",on:{click:function(s){return t.removeOption(i,e)}}},[t._v("delete")])])]})),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newOption[e],expression:"newOption[field]"}],staticClass:"mr-2",attrs:{type:"text"},domProps:{value:t.newOption[e]},on:{input:function(s){s.target.composing||t.$set(t.newOption,e,s.target.value)}}}),s("button",{on:{click:function(s){return t.addOption(e)}}},[t._v("Aggiungi")])],2):t._e(),t.schema[e].tab===t.tab&&"date"===t.schema[e].type?s("div",[s("input",{staticClass:"w-24",attrs:{type:"text"},domProps:{value:t.dateField(e,t.$attrs.value[e])},on:{blur:function(s){return t.updateField(e,s.target.value)}}})]):t._e()]):t._e(),t.schema[e].tab===t.tab&&"boolean"===t.schema[e].type?s("div",{staticClass:"flex flex-row justify-start"},["boolean"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"mr-4",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.record[e])?t._i(t.record[e],null)>-1:t.record[e]},on:{input:function(e){return t.$emit(e.target.value)},change:function(s){var a=t.record[e],i=s.target,n=!!i.checked;if(Array.isArray(a)){var o=null,r=t._i(a,o);i.checked?r<0&&t.$set(t.record,e,a.concat([o])):r>-1&&t.$set(t.record,e,a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.record,e,n)}}}):t._e(),s("span",{staticClass:"ml-2 capitalize"},[t._v(t._s(t.schema[e].label))])]):t._e()]})),3===t.tab?s("div",{staticClass:"w-full col-span-2"},[s("survey-questions",{attrs:{survey:t.$attrs.value._id}})],1):t._e()],2):t._e(),s("transition",{attrs:{name:"fade"}},[t.editor?s("moka-modal",{attrs:{size:"lg",position:"modal"},on:{close:function(e){t.editor=!t.editor}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Editor")]),s("div",{attrs:{slot:"content"},slot:"content"},[s("v-editor",{model:{value:t.$attrs.value.description,callback:function(e){t.$set(t.$attrs.value,"description",e)},expression:"$attrs.value.description"}})],1)]):t._e()],1)],1)},i=[],n=(s("1276"),s("ac1f"),s("a434"),s("7db0"),s("b64b"),s("fda7")),o=s("1816"),r=s("79cc"),l={name:"TSISurveyAdmin",components:{VEditor:o["default"],SurveyQuestions:r["default"]},props:["data"],data:function(){return{editor:!1,tab:0,record:{},domande:null,editDomande:!1,total:0,newOption:{},newOptionValue:""}},computed:{schema:function(){return n["default"].questionario}},methods:{dateField:function(t,e){console.log(e);var s=this.schema[t].format(e);return s},updateArray:function(t,e,s){this.$attrs.value[e][t]=s,console.log(t,this.$attrs.value[e][t],s)},updateField:function(t,e){var s=e.split("/");s=s[2]+s[1]+s[0],this.$attrs.value[t]=s},addOption:function(t){this.$attrs.value[t].push(this.newOption[t])},removeOption:function(t,e){console.log(t,e),this.$attrs.value[e].splice(t,1)},getDomande:function(){var t=this;this.$api.service("questions").find({query:{id:this.$attrs.value.id}}).then((function(e){t.domande=e.data[0],t.total=Object.keys(t.domande.questions).length}))}},mounted:function(){this.record=this.$attrs.value,this.getDomande()}},c=l,d=s("2877"),u=Object(d["a"])(c,a,i,!1,null,null,null);e["default"]=u.exports}}]);