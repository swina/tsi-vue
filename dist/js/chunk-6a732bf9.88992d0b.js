(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a732bf9","chunk-34c6eaf8","chunk-2d222424","chunk-2d0d83b8"],{"79cc":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.questions?s("div",{staticClass:"relative w-full overflow-y-auto m-4 flex flex-col"},[t._l(Object.keys(t.questions),(function(e,a){return[a>=t.start&&a<=t.start+t.limit?s("div",{staticClass:"flex flex-row mb-1 items-center"},[s("div",{staticClass:"w-10 text-right text-lg bg-gray-200 pr-2 mr-2 p-1"},[t._v(t._s(e))]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.questions[e].domanda,expression:"questions[question].domanda"}],staticClass:"bg-white w-9/12 p-1r",staticStyle:{"font-family":"'Arial'"},attrs:{type:"text"},domProps:{value:t.questions[e].domanda},on:{input:function(s){s.target.composing||t.$set(t.questions[e],"domanda",s.target.value)}}}),t._m(0,!0)]):t._e()]})),s("div",{staticClass:"w-full flex flex-row items-center p-2 justify-center"},[s("button",{staticClass:"rounded-bl rounded-tl",on:{click:function(e){t.start>0&&(t.start=t.start-t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_left")])]),s("button",{staticClass:"rounded-tr rounded-br",on:{click:function(e){t.start+t.limit<t.total&&(t.start=t.start+t.limit)}}},[s("i",{staticClass:"material-icons"},[t._v("chevron_right")])])]),s("div",{staticClass:"w-full flex flex-row items-center p-2 justify-center"},[s("button",{staticClass:"rounded success",on:{click:t.save}},[t._v("Salva Quesiti")])])],2):t._e()},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"w-2/12 p-1 text-gray-500"},[s("i",{staticClass:"material-icons"},[t._v("delete")])])}],r=(s("7db0"),s("b64b"),{data:function(){return{questions:null,currentIndex:-1,start:0,limit:10,total:0,edit:!1}},computed:{},methods:{save:function(){}},mounted:function(){var t=this;this.$api.service("questions").find({query:{id:this.$attrs.survey}}).then((function(e){t.$store.dispatch("dataset",{table:"questions",data:e.data[0].questions}),t.questions=e.data[0].questions,t.total=Object.keys(t.questions).length}))}}),n=r,o=s("2877"),c=Object(o["a"])(n,a,i,!1,null,null,null);e["default"]=c.exports},b9a1:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"m-2"},[s("button",{class:0===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=0}}},[t._v("Generale")]),s("button",{class:2===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=2}}},[t._v("Risposte")]),s("button",{class:3===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=3}}},[t._v("Domande")]),s("button",{class:1===t.tab?"bg-blue-400":"",on:{click:function(e){t.tab=1}}},[t._v("Descrizione")]),t.schema?s("div",{staticClass:"grid grid-cols-2 gap-4 p-8 border rounded"},[t._l(Object.keys(t.schema),(function(e){return[t.schema[e].tab===t.tab&&"boolean"!=t.schema[e].type?s("div",{staticClass:"flex flex-col",class:"text"===t.schema[e].type?"col-span-2":""},[s("label",{staticClass:"font-bold capitalize"},[t._v(t._s(t.schema[e].label))]),t.schema[e].tab===t.tab&&"string"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",attrs:{type:"text"},domProps:{value:t.record[e]},on:{input:[function(s){s.target.composing||t.$set(t.record,e,s.target.value)},function(e){return t.$emit(e.target.value)}]}}):t._e(),t.schema[e].tab===t.tab&&"number"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",attrs:{type:"number",min:"1"},domProps:{value:t.record[e]},on:{input:[function(s){s.target.composing||t.$set(t.record,e,s.target.value)},function(e){return t.$emit(e.target.value)}]}}):t._e(),"excerpt"===t.schema[e].type?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"w-full",domProps:{value:t.record[e]},on:{input:function(s){s.target.composing||t.$set(t.record,e,s.target.value)}}}):t._e(),t.schema[e].tab===t.tab&&"text"===t.schema[e].type?s("div",["text"===t.schema[e].type?s("v-editor",{staticClass:"w-full",model:{value:t.$attrs.value.description,callback:function(e){t.$set(t.$attrs.value,"description",e)},expression:"$attrs.value.description"}}):t._e()],1):t._e(),t.schema[e].tab===t.tab&&"array"===t.schema[e].type?s("div",[t._l(t.$attrs.value[e],(function(a,i){return[s("div",{staticClass:"flex flex-row"},[s("input",{staticClass:"w-full",attrs:{type:"text"},domProps:{value:a},on:{input:function(s){return t.updateArray(i,e,s.target.value)}}}),t._v(" "),s("i",{staticClass:"material-icons ml-2",on:{click:function(s){return t.removeOption(i,e)}}},[t._v("delete")])])]})),s("input",{directives:[{name:"model",rawName:"v-model",value:t.newOption[e],expression:"newOption[field]"}],staticClass:"mr-2",attrs:{type:"text"},domProps:{value:t.newOption[e]},on:{input:function(s){s.target.composing||t.$set(t.newOption,e,s.target.value)}}}),s("button",{on:{click:function(s){return t.addOption(e)}}},[t._v("Aggiungi")])],2):t._e(),t.schema[e].tab===t.tab&&"date"===t.schema[e].type?s("div",[s("input",{staticClass:"w-24",attrs:{type:"text"},domProps:{value:t.dateField(e,t.$attrs.value[e])},on:{blur:function(s){return t.updateField(e,s.target.value)}}})]):t._e()]):t._e(),t.schema[e].tab===t.tab&&"boolean"===t.schema[e].type?s("div",{staticClass:"flex flex-row justify-start"},["boolean"===t.schema[e].type?s("input",{directives:[{name:"model",rawName:"v-model",value:t.record[e],expression:"record[field]"}],staticClass:"mr-4",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.record[e])?t._i(t.record[e],null)>-1:t.record[e]},on:{input:function(e){return t.$emit(e.target.value)},change:function(s){var a=t.record[e],i=s.target,r=!!i.checked;if(Array.isArray(a)){var n=null,o=t._i(a,n);i.checked?o<0&&t.$set(t.record,e,a.concat([n])):o>-1&&t.$set(t.record,e,a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.record,e,r)}}}):t._e(),s("span",{staticClass:"ml-2 capitalize"},[t._v(t._s(t.schema[e].label))])]):t._e()]})),3===t.tab?s("div",{staticClass:"w-full col-span-2"},[s("survey-questions",{attrs:{survey:t.$attrs.value._id}})],1):t._e()],2):t._e(),s("transition",{attrs:{name:"fade"}},[t.editor?s("moka-modal",{attrs:{size:"lg",position:"modal"},on:{close:function(e){t.editor=!t.editor}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Editor")]),s("div",{attrs:{slot:"content"},slot:"content"},[s("v-editor",{model:{value:t.$attrs.value.description,callback:function(e){t.$set(t.$attrs.value,"description",e)},expression:"$attrs.value.description"}})],1)]):t._e()],1)],1)},i=[],r=(s("1276"),s("ac1f"),s("a434"),s("7db0"),s("b64b"),s("fda7")),n=s("1816"),o=s("79cc"),c={name:"TSISurveyAdmin",components:{VEditor:n["default"],SurveyQuestions:o["default"]},props:["data"],data:function(){return{editor:!1,tab:0,record:{},domande:null,editDomande:!1,total:0,newOption:{},newOptionValue:""}},computed:{schema:function(){return r["default"].questionario}},methods:{dateField:function(t,e){console.log(e);var s=this.schema[t].format(e);return s},updateArray:function(t,e,s){this.$attrs.value[e][t]=s,console.log(t,this.$attrs.value[e][t],s)},updateField:function(t,e){var s=e.split("/");s=s[2]+s[1]+s[0],this.$attrs.value[t]=s},addOption:function(t){this.$attrs.value[t].push(this.newOption[t])},removeOption:function(t,e){console.log(t,e),this.$attrs.value[e].splice(t,1)},getDomande:function(){var t=this;this.$api.service("questions").find({query:{id:this.$attrs.value.id}}).then((function(e){t.domande=e.data[0],t.total=Object.keys(t.domande.questions).length}))}},mounted:function(){this.record=this.$attrs.value,this.getDomande()}},l=c,u=s("2877"),d=Object(u["a"])(l,a,i,!1,null,null,null);e["default"]=d.exports},cde6:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-sm w-full m-auto border shadow"},[s("div",{class:"bg-gray-300 p-2 pb-1 items-center justify-center grid grid-cols-"+(t.cols+1)},[t._l(t.fields,(function(e){return["_id"!=e&&t.schema[e].list?s("div",{staticClass:"font-bold capitalize"},[t._v(t._s(e))]):t._e()]})),s("div",{})],2),t._l(t.datastore.dataset.surveys,(function(e){return[s("div",{class:"p-2 pb-1 border-b w-full hover:bg-gray-100 items-center cursor-pointer grid grid-cols-"+(t.cols+1)},[t._l(t.fields,(function(a){return["_id"!=a&&t.schema[a].list?s("div",[t._v(t._s(t.schema[a].format(e[a])))]):t._e()]})),s("div",{staticClass:"flex flex-row text-xl justify-end items-center"},[s("icon",{staticClass:"border rounded h-8 w-8 text-center hover:bg-blue-300",attrs:{name:"edit",title:"Modifica"},on:{click:function(s){t.record=e,t.edit=!t.edit}}}),s("icon",{staticClass:"border rounded h-8 w-8 text-center hover:bg-blue-300 mx-2",attrs:{name:"people",title:"Utenti"},on:{click:function(s){t.record=e,t.tab("persons")}}}),s("icon",{staticClass:"border rounded h-8 w-8 text-center hover:bg-blue-300",attrs:{name:"launch",title:"Test"},on:{click:function(s){return t.simulator(e._id)}}})],1)],2)]})),s("transition",{attrs:{name:"fade"}},[s("div",[t.edit?s("moka-modal",{attrs:{size:"full",position:""},on:{close:function(e){t.edit=!t.edit},click_0:function(e){t.edit=!t.edit},click_1:t.save}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.record.project))]),t.edit?s("survey-admin",{attrs:{slot:"content"},slot:"content",model:{value:t.record,callback:function(e){t.record=e},expression:"record"}}):t._e()],1):t._e()],1)])],2)},i=[],r=s("5530"),n=(s("159b"),s("d3b7"),s("3ca3"),s("ddb0"),s("b64b"),s("2f62")),o=s("b9a1"),c=s("ce9e"),l={name:"TSISurveysAdmin",components:{SurveyAdmin:o["default"],SurveyPersons:c["default"]},data:function(){return{schema:null,fields:null,record:null,persons:!1,edit:!1}},watch:{},computed:Object(r["a"])(Object(r["a"])({},Object(n["b"])(["desktop","datastore"])),{},{cols:function(){var t=this,e=0;return this.fields&&this.fields.forEach((function(s){t.schema[s].list&&e++})),e}}),methods:{simulator:function(t){return null},save:function(){var t=this;this.$api.service("surveys").patch(this.record._id,this.record).then((function(e){t.edit=!1,t.$message("Dati salvati con successo")}))},tab:function(t){this.desktop.tabs.push({component:function(){return s("db06")("./survey."+t)},name:"Utenti",icon:"people",filter:this.record,ref:this.$randomID(),resumeAction:null,blocks:null}),this.desktop.currentTab=this.desktop.tabs.length-1}},beforeMount:function(){this.fields=Object.keys(this.datastore.dataset.schema.surveys),this.schema=this.datastore.dataset.schema.surveys}},u=l,d=s("2877"),v=Object(d["a"])(u,a,i,!1,null,null,null);e["default"]=v.exports},ce9e:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.persons?s("div",{staticClass:"text-sm border shadow"},[s("div",{staticClass:"w-full bg-gray-500 text-white p-1"},[t._v(t._s(t.$attrs.filter.project))]),s("div",{class:"p-2 pb-1 bg-gray-200 w-full grid grid-cols-"+(t.cols+1)},[t._l(t.fields,(function(e){return[t.schema[e].list?s("div",{staticClass:"font-bold capitalize"},[t._v(" "+t._s(e)+" ")]):t._e()]}))],2),t._l(t.persons,(function(e){return[s("div",{class:"p-2 pb-1 border-b w-full hover:bg-gray-100 items-center cursor-pointer grid grid-cols-"+(t.cols+1)},[t._l(t.fields,(function(a){return["_id"!=a&&t.schema[a].list?s("div",[t._v(t._s(t.schema[a].format(e[a])))]):t._e()]})),s("div",{staticClass:"flex flex-row text-xl justify-end items-center"},[s("icon",{staticClass:"border rounded h-8 w-8 text-center hover:bg-blue-300",attrs:{name:"edit",title:"Modifica"},on:{click:function(e){t.record=t.survey,t.edit=!t.edit}}}),s("icon",{staticClass:"border rounded h-8 w-8 text-center hover:bg-blue-300 mx-2",attrs:{name:"quiz",title:"Risposte"},on:{click:function(e){t.record=t.survey,t.answers=!t.answers}}})],1)],2)]}))],2):t._e()},i=[],r=s("5530"),n=(s("b64b"),s("159b"),s("4de4"),s("7db0"),s("2f62")),o={name:"TSISurveyPersons",data:function(){return{persons:null,schema:null,edit:!1,answers:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(n["b"])(["datastore"])),{},{fields:function(){return this.schema=this.datastore.dataset.schema.persons,Object.keys(this.datastore.dataset.schema.persons)},cols:function(){var t=this,e=0;return this.fields&&this.fields.forEach((function(s){t.datastore.dataset.schema.persons[s].list&&e++})),e}}),mounted:function(){var t=this;this.datastore.dataset.persons&&this.datastore.dataset.currentSurvey?this.datastore.dataset.currentSurvey._id===this.$attrs.filter._id&&(this.persons=this.datastore.dataset.persons):this.$api.service("persons").find({query:{survey_id:this.$attrs.survey||this.$attrs.filter._id}}).then((function(e){t.$store.dispatch("dataset",{table:"persons",data:e.data}),t.$store.dispatch("dataset",{table:"currentSurvey",data:t.$attrs.filter}),t.persons=e.data}))}},c=o,l=s("2877"),u=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=u.exports},db06:function(t,e,s){var a={"./survey.admin":"b9a1","./survey.admin.vue":"b9a1","./survey.persons":"ce9e","./survey.persons.vue":"ce9e","./survey.questions":"79cc","./survey.questions.vue":"79cc"};function i(t){return Promise.resolve().then((function(){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}var i=a[t];return s(i)}))}i.keys=function(){return Object.keys(a)},i.id="db06",t.exports=i}}]);